// Firestore Security Rules — email-based admin, per‑user isolation
rules_version = '2';
service cloud.firestore {
  match /databases/{db}/documents {

    // Employee profile
    match /employees/{uid} {
      allow read: if request.auth != null && (
        request.auth.uid == uid ||
        request.auth.token.email == 'admin@rashid.com' // change if ADMIN_EMAIL changed
      );
      allow create: if request.auth != null && request.resource.data.ownerUid == null && request.auth.uid == uid;
      allow update, delete: if request.auth != null && (
        request.auth.uid == uid ||
        request.auth.token.email == 'admin@rashid.com'
      );
    }

    // Employee expenses
    match /employees/{uid}/expenses/{expId} {
      allow read, write: if request.auth != null && (
        request.auth.uid == uid ||
        request.auth.token.email == 'admin@rashid.com'
      );
    }

    // Employee attendance
    match /employees/{uid}/attendance/{date} {
      allow read, write: if request.auth != null && (
        request.auth.uid == uid ||
        request.auth.token.email == 'admin@rashid.com'
      );
    }
  }
}
